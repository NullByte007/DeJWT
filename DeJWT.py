import argparse
import base64


def decoder(token):

    banner ="""

+==============================================================================================+
    
    ░░░░░██╗░██╗░░░░░░░██╗████████╗  ██████╗░███████╗░█████╗░░█████╗░██████╗░███████╗██████╗░
    ░░░░░██║░██║░░██╗░░██║╚══██╔══╝  ██╔══██╗██╔════╝██╔══██╗██╔══██╗██╔══██╗██╔════╝██╔══██╗
    ░░░░░██║░╚██╗████╗██╔╝░░░██║░░░  ██║░░██║█████╗░░██║░░╚═╝██║░░██║██║░░██║█████╗░░██████╔╝
    ██╗░░██║░░████╔═████║░░░░██║░░░  ██║░░██║██╔══╝░░██║░░██╗██║░░██║██║░░██║██╔══╝░░██╔══██╗
    ╚█████╔╝░░╚██╔╝░╚██╔╝░░░░██║░░░  ██████╔╝███████╗╚█████╔╝╚█████╔╝██████╔╝███████╗██║░░██║
    ░╚════╝░░░░╚═╝░░░╚═╝░░░░░╚═╝░░░  ╚═════╝░╚══════╝░╚════╝░░╚════╝░╚═════╝░╚══════╝╚═╝░░╚═╝
+==============================================================================================+
|  CODE BY: Aniket Bhagwate (NullByte007)                                                      |
+==============================================================================================+

    """

    print(banner)

    token = token.split(".")
    
    header = token[0]
    pad = (4 - (len(header) % 4))
    header = header + "=" * pad

    payload = token[1]
    pad = (4 - (len(payload) % 4))
    payload = payload + "=" * pad
    
    signature = token[2]

    print("|TOKEN INFORMATION|")
    print("+==========================================================================+")
    print("| HEADER    : " +  base64.b64decode(header).decode() )
    print("+==========================================================================+")
    print("| PAYLOAD   : " + base64.b64decode(payload).decode() )
    print("+==========================================================================+")
    print("| SIGNATURE : " + signature  )
    print("+==========================================================================+")
    

def main():
    parser = argparse.ArgumentParser("Bruteforce for HTTP login pages")
    parser.add_argument('-t', '--token', metavar="JWT Token", required=True, help="The JWT token to decode ")
    
    args = parser.parse_args()
    decoder(args.token)

if __name__ =='__main__':
    main()